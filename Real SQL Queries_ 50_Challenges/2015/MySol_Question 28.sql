USE AdventureWorks2012;

SELECT DATEDIFF(DAY, '20120501', '20120524') AS TOTD
			,SUM(SH.SubTotal) AS REVENUE
			,SUM(SH.SubTotal)/DATEDIFF(DAY, '20120501', '20120524') AS REVPERDAY
			,SUM(SH.SubTotal)/DATEDIFF(DAY, '20120501', '20120524') * DAY(EOMONTH('20120524')) AS PROJREV
			,DAY(EOMONTH('20120524')) AS NOOFDAYS
FROM Sales.SalesOrderHeader AS SH
WHERE SH.OrderDate >= '20120501' AND SH.OrderDate < '20120524'



SELECT	SUM(SH.SubTotal) AS REVENUE
		,SUM(SH.SubTotal)/DAY(EOMONTH('20120524')) AS REVPERDAY
		,DAY(EOMONTH('20120524')) AS NOOFDAYS
FROM Sales.SalesOrderHeader AS SH
WHERE SH.OrderDate >= '20120501' AND SH.OrderDate <= '20120531'
